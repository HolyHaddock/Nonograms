module Main  where

import Solver
import Criterion (nf)
import Criterion.Main (defaultMain, bench)

main = defaultMain $ zipWith benchIt [1..] solvableBoards
  where
    benchIt i b = bench ("Board " ++ show i) $ nf solveIt b
    solveIt b = length $ constraintSolve b (emptyBoard b)

solvableBoards = [testBoard, testBoard2, testBoard3, testBoard4, testBoard6, testBoard7, testBoard8]

currentlyInsoluable = 
                      [ testBoard9 -- 20x15
                      , testBoard5
                      , testBoard10
                      , testBoard11
                      , testBoard12
                      ]

testBoard = problem
  [[3,5]   -- Going down the horizontals
  , [4,2,1]
  , [3,1,4]
  , [1,2,5]
  , [8]
  , [7]
  , [6]
  , [3,1,3]
  , [3,1,7]
  , [3,5,3]
  , [2,1,7,2]
  , [1,3]
  , [1]
  , [4,1,1]
  , [4,1,2,2]]
   [[4,4,2]  -- Going across the verticals:
  , [3,4,2]
  , [3,3,2]
  , [1,1,2]
  , [2,3]
  , [4,3]
  , [7]
  , [5,3,1]
  , [9]
  , [4,4,2]
  , [6,3,1]
  , [5,1,1]
  , [1,1,1,2]
  , [1,1,3,1]
  , [2,3,2]]
-- Examples found at http://87.230.22.228/examples/nono.ecl.txt

testBoard2 = problem 
  [[1,2],[3,1],[1,5],[7,1],[5],[3],[4],[3]]		-- column blocks
  [[3],[2,1],[3,2],[2,2],[6],[1,5],[6],[1],[2]]	        -- row blocks


-- from http://www.pro.or.jp/~fuji/java/puzzle/nonogram/index-eng.html
testBoard3 = problem
  [[4],[1 ,3],[2,3],[1,2],[2,2],[1,1,1],[1,1,1,1],[1,1,1],[1,2],[5]]
  [[1],[3],[1,3],[2,4],[1,2],[2,1,1],[1,1,1,1],[2,1,1],[2,2],[5]]

testBoard4 = problem
  [[4],[1,2],[1,1],[5,1],[1,2],[1,1],[5,1],[1,1],[4,1],[4,1],[4,2],[4,1],[4,1],[4,2],[4]]
  [[4],[1,1,6],[1,1,6],[1,1,6],[4,9],[1,1],[1,1],[2,7,2],[1,1,1,1],[2,2]]

testBoard5 = problem
  [[1,2],[1],[2],[2],[1],[2,1]]
  [[2,1],[1],[2],[2],[1],[1,2]]

testBoard6 = problem
  [[1],[1,2],[1,2],[1,1],[2,5],[7],[2,5],[1],[2],[2]]
  [[3],[3],[1],[3],[6],[3],[3],[3,3],[2,2],[2,1]]

testBoard7 = problem
  [[4],[2,2],[1,5],[1,2,2],[5,2,1],[2,1,1,2],[1,3,1],[1,1,6],[1,3,1],[2,1,2,2],[4,2,1],[1,1,1],[1,3,2],[2,2,3],[4]]
  [[5],[2,2],[1,1],[1,1],[4,4],[2,2,1,2],[1,3,1],[1,1,1,1],[2,7,2],[4,1,5],[2,1,1],[1,1,2],[1,1,1],[2,5,2],[3,4]]

testBoard8 = problem
  [[5,1],[2,1,1,1],[2,1,1,2],[2,3,3],[2,1],[2,3,6],[1,1,1,1,1],[1,1,1,1,1],[2,3,6],[2,1],[2,3,1],[2,1,1,1],[2,1,1,4],[7],[1,1]]
  [[4],[2,2],[2,2],[2,4,2],[2,1,1,2],[2,4,2],[1,2],[4,4,4],[1,1,1,1,1,1],[4,1,1,4],[1,1,1],[1,1,3],[10],[2,1],[4,1]]

-- from http://www.puzzle.gr.jp/nonogram/prob/0200_e.html
testBoard9 = problem	-- difficulty 7
    [[4,3],[6,1,2,3],[2,3],[6],[1,2,2],[1,1,2],[2,4,1,1],[1,1,2,2,2,1],[1,1,1,2,1,1],[1,3,2,3],[3,2,2],[4,3,4,2],[1,3,4,5],[2,2],[3]]
    [[3],[1,2],[1,4],[1,1,2],[1,1,1,1],[1,3,2],[2,3,1],[1,1,1,2],[2,2,2],[1,1,2,2],[1,1,2,2],[1,1,1,1],[4,1,1],[2,2,2,1],[2,3,3],[2,2,3],[1,3,1,1],[2,1,1,1,2],[1,2,3],[1,6]]

testBoard10 = problem	-- difficulty 8
  [[6,1],[8,3],[3,2,1],[1,1,2,2,1],[1,2,2,1,1],[1,1,1,1],[2,3],[4,1,2,2],[5,2,1],[8,1,1],[7,2],[3,5,2],[2,5],[2,1,4],[2,2,2,2],[2,2,1,1,1],[3,1,1,1,1],[5,4,2,1],[7,4,1,1],[4]]
  [[1,1,4],[1,6],[1,1,1,1,2,3],[1,1,2,3],[3,1,2,3],[4,5,2,2],[7,3,2],[3,5,1,2],[2,2,4,1],[2,2,3,4],[2,5,2],[2,1,5,1],[2,2,3,1],[6,2,2],[1,7],[2,2,2],[1,4],[3,1,1],[1,1],[1,1]]

testBoard11 = problem	-- difficulty 9
  [[2,2,3],[4,1,1,1,4],[4,1,2,1,1],[4,1,1,1,1,1,1],[2,1,1,2,3,5],[1,1,1,1,2,1],[3,1,5,1,2],[3,2,2,1,2,2],[2,1,4,1,1,1,1],[2,2,1,2,1,2],[1,1,1,3,2,3],[1,1,2,7,3],[1,2,2,1,5],[3,2,2,1,2],[3,2,1,2],[5,1,2],[2,2,1,2],[4,2,1,2],[6,2,3,2],[7,4,3,2],[7,4,4],[7,1,4],[6,1,4],[4,2,2],[2,1]]
   [[1,1,2,2],[5,5,7],[5,2,2,9],[3,2,3,9],[1,1,3,2,7],[3,1,5],[7,1,1,1,3],[1,2,1,1,2,1],[4,2,4],[1,2,2,2],[4,6,2],[1,2,2,1],[3,3,2,1],[4,1,15],[1,1,1,3,1,1],[2,1,1,2,2,3],[1,4,4,1],[1,4,3,2],[1,1,2,2],[7,2,3,1,1],[2,1,1,1,5],[1,2,5],[1,1,1,3],[4,2,1],[3]]

-- the example quoted in Optima#65, Mathematical Programming Society Newsletter
testBoard12 = problem
  [[1,1,1,2],[3,1,2,1,1],[1,4,2,1,1],[1,3,2,4],[1,4,6,1],[1,11,1],[5,1,6,2],[14],[7,2],[7,2],[6,1,1],[9,2],[3,1,1,1],[3,1,3],[2,1,3],[2,1,5],[3,2,2],[3,3,2],[2,3,2],[2,6]]
   [[7,1],[1,1,2],[2,1,2],[1,2,2],[4,2,3],[3,1,4],[3,1,3],[2,1,4],[2,9],[2,1,5],[2,7],[14],[8,2],[6,2,2],[2,8,1,3],[1,5,5,2],[1,3,2,4,1],[3,1,2,4,1],[1,1,3,1,3],[2,1,1,2]]
